{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport React, { useState, useEffect, useContext } from \"react\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport Modal from \"react-native-web/dist/exports/Modal\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport * as Location from \"expo-location\";\nimport { getNearbyFriends, sendMessage, setUserLocation } from \"../api\";\nimport { UserContext } from \"../Context\";\nimport { FriendItemList } from \"../components/FriendItemList\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nexport default function LocationScreen(_ref) {\n  var navigation = _ref.navigation,\n      handleLogoutCallback = _ref.handleLogoutCallback;\n  var authToken = useContext(UserContext);\n\n  var _useState = useState(null),\n      _useState2 = _slicedToArray(_useState, 2),\n      location = _useState2[0],\n      setLocation = _useState2[1];\n\n  var _useState3 = useState(1.9441),\n      _useState4 = _slicedToArray(_useState3, 2),\n      latitude = _useState4[0],\n      setLatitude = _useState4[1];\n\n  var _useState5 = useState(null),\n      _useState6 = _slicedToArray(_useState5, 2),\n      friends = _useState6[0],\n      setFriends = _useState6[1];\n\n  var _useState7 = useState(\"\"),\n      _useState8 = _slicedToArray(_useState7, 2),\n      clickedFriend = _useState8[0],\n      setClickedFriend = _useState8[1];\n\n  var _useState9 = useState(\"\"),\n      _useState10 = _slicedToArray(_useState9, 2),\n      clickedFriendId = _useState10[0],\n      setClickedFriendId = _useState10[1];\n\n  var _useState11 = useState(30.0619),\n      _useState12 = _slicedToArray(_useState11, 2),\n      longitude = _useState12[0],\n      setLongitude = _useState12[1];\n\n  var _useState13 = useState(false),\n      _useState14 = _slicedToArray(_useState13, 2),\n      modalVisible = _useState14[0],\n      setModalVisible = _useState14[1];\n\n  var _useState15 = useState(null),\n      _useState16 = _slicedToArray(_useState15, 2),\n      errorMsg = _useState16[0],\n      setErrorMsg = _useState16[1];\n\n  var _useState17 = useState(false),\n      _useState18 = _slicedToArray(_useState17, 2),\n      isEnabled = _useState18[0],\n      setIsEnabled = _useState18[1];\n\n  var _useState19 = useState(\"\"),\n      _useState20 = _slicedToArray(_useState19, 2),\n      message = _useState20[0],\n      setMessage = _useState20[1];\n\n  var toggleSwitch = function toggleSwitch() {\n    return setIsEnabled(function (previousState) {\n      return !previousState;\n    });\n  };\n\n  var handleOpen = function handleOpen(id, firstName, lastName) {\n    setClickedFriend(firstName + \" \" + lastName);\n    setClickedFriendId(id);\n    setModalVisible(true);\n  };\n\n  useEffect(function () {\n    (function _callee() {\n      var _await$Location$reque, status;\n\n      return _regeneratorRuntime.async(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return _regeneratorRuntime.awrap(Location.requestForegroundPermissionsAsync());\n\n            case 2:\n              _await$Location$reque = _context.sent;\n              status = _await$Location$reque.status;\n              console.log(\"hahah\", status);\n\n              if (!(status !== \"granted\")) {\n                _context.next = 8;\n                break;\n              }\n\n              setErrorMsg(\"Permission to access location was denied\");\n              return _context.abrupt(\"return\");\n\n            case 8:\n              getNearbyFriends(authToken).then(function (resp) {\n                setFriends(resp.data);\n                console.log(resp.data);\n              }).catch(function (error) {\n                console.log(\"error near friends\", error.message);\n              });\n              Location.getCurrentPositionAsync({}).then(function (resp) {\n                var coords = resp[\"coords\"];\n                setLatitude(coords[\"latitude\"]);\n                setLongitude(coords[\"longitude\"]);\n                setUserLocation(authToken, coords[\"longitude\"], coords[\"latitude\"]).then(function (results) {\n                  console.log(\"location saved\", results.status);\n                }).catch(function (err) {\n                  console.log(err);\n                });\n              });\n\n            case 10:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    })();\n  }, []);\n  var text = \"Waiting..\";\n\n  if (errorMsg) {\n    text = errorMsg;\n  } else if (location) {}\n\n  var FlatListBasics = function FlatListBasics(distance) {\n    return _jsx(View, {\n      children: _jsx(FlatList, {\n        data: friends ? friends[\"\" + distance] : [],\n        renderItem: function renderItem(_ref2) {\n          var item = _ref2.item;\n          return _jsx(FriendItemList, {\n            data: item,\n            handleOpen: handleOpen\n          });\n        }\n      })\n    });\n  };\n\n  var handleSendingMessage = function handleSendingMessage() {\n    if (message.match(/(?!^ +$)^.+$/)) {\n      var trimmedMessage = message.trim();\n      sendMessage(authToken, clickedFriendId, trimmedMessage).then(function (response) {\n        console.log(\"testing chating\", response);\n      }).catch(function (err) {\n        console.log(err);\n      });\n      setModalVisible(!modalVisible);\n      navigation.navigate(\"message\", {\n        friendId: clickedFriendId,\n        firstName: clickedFriend.split(\" \")[0],\n        lastName: clickedFriend.split(\" \")[1]\n      });\n    }\n  };\n\n  return _jsxs(View, {\n    style: styles.container,\n    children: [friends && friends[\"1\"].length > 0 ? _jsxs(View, {\n      children: [_jsx(Text, {\n        style: styles.title,\n        children: \"1 mile away\"\n      }), FlatListBasics(1)]\n    }) : _jsx(View, {}), friends && friends[\"2\"].length > 0 ? _jsxs(View, {\n      children: [_jsx(Text, {\n        style: styles.title,\n        children: \"2 mile away\"\n      }), FlatListBasics(2)]\n    }) : _jsx(View, {}), friends && friends[\"3\"].length > 0 ? _jsxs(View, {\n      children: [_jsx(Text, {\n        style: styles.title,\n        children: \"3 mile away\"\n      }), FlatListBasics(3)]\n    }) : _jsx(View, {}), _jsx(Modal, {\n      animationType: \"fade\",\n      transparent: true,\n      visible: modalVisible,\n      onRequestClose: function onRequestClose() {\n        Alert.alert(\"Modal has been closed.\");\n        setModalVisible(!modalVisible);\n      },\n      children: _jsx(View, {\n        style: styles.centeredView,\n        children: _jsxs(View, {\n          style: styles.modalView,\n          children: [_jsx(View, {\n            style: {\n              width: \"100%\",\n              backgroundColor: \"blue\",\n              marginBottom: 30\n            },\n            children: _jsx(View, {\n              style: {\n                position: \"absolute\",\n                right: 0\n              },\n              children: _jsx(Button, {\n                title: \"Close\",\n                onPress: function onPress() {\n                  setMessage(\"\");\n                  setModalVisible(!modalVisible);\n                }\n              })\n            })\n          }), _jsx(Image, {\n            style: styles.imageModal,\n            source: {\n              uri: \"https://images-na.ssl-images-amazon.com/images/I/81nKBuQzyjL.jpg\"\n            }\n          }), _jsx(Text, {\n            style: {\n              fontSize: 28\n            },\n            children: clickedFriend\n          }), _jsx(Text, {\n            children: \"Quick Texts\"\n          }), _jsxs(View, {\n            style: {\n              width: \"80%\",\n              marginTop: 10\n            },\n            children: [_jsx(TouchableOpacity, {\n              style: {\n                flexDirection: \"column\"\n              },\n              onPress: function onPress() {\n                setMessage(\"Wanna get some lunch?\");\n              },\n              children: _jsx(View, {\n                style: styles.button,\n                children: _jsx(Text, {\n                  children: \"Wanna get some lunch?\"\n                })\n              })\n            }), _jsx(TouchableOpacity, {\n              onPress: function onPress() {\n                setMessage(\"What are you up to?\");\n              },\n              children: _jsx(View, {\n                style: styles.button,\n                children: _jsx(Text, {\n                  children: \"What are you up to?\"\n                })\n              })\n            }), _jsx(TouchableOpacity, {\n              onPress: function onPress() {\n                setMessage(\"Wanna grab a drink?\");\n              },\n              children: _jsx(View, {\n                style: styles.button,\n                children: _jsx(Text, {\n                  children: \"Wanna grab a drink?\"\n                })\n              })\n            })]\n          }), _jsxs(View, {\n            style: {\n              flexDirection: \"row\",\n              alignItems: \"center\",\n              borderWidth: 1,\n              borderColor: \"#DDDDDD\",\n              borderRadius: 40,\n              paddingLeft: 15,\n              paddingRight: 15,\n              width: \"80%\"\n            },\n            children: [_jsx(View, {\n              style: {\n                flex: 2.25\n              },\n              children: _jsx(TextInput, {\n                value: message,\n                style: styles.input,\n                placeholder: \"useless placeholder\",\n                onChangeText: function onChangeText(e) {\n                  setMessage(e);\n                }\n              })\n            }), _jsx(View, {\n              style: {\n                flex: 0.75\n              },\n              children: _jsx(Button, {\n                title: \"send\",\n                onPress: handleSendingMessage\n              })\n            })]\n          })]\n        })\n      })\n    })]\n  });\n}\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1\n  },\n  map: {\n    width: \"100%\",\n    height: \"100%\",\n    zIndex: 1\n  },\n  imageModal: {\n    width: 100,\n    height: 100,\n    borderRadius: 50,\n    marginBottom: 5\n  },\n  modalView: {\n    margin: 20,\n    backgroundColor: \"white\",\n    borderRadius: 10,\n    padding: 5,\n    alignItems: \"center\",\n    shadowColor: \"#000\",\n    shadowOffset: {\n      width: 0,\n      height: 2\n    },\n    shadowOpacity: 0.25,\n    shadowRadius: 4,\n    elevation: 5,\n    height: \"60%\",\n    width: \"80%\"\n  },\n  button: {\n    borderRadius: 20,\n    padding: 10,\n    elevation: 2,\n    backgroundColor: \"#DDDDDD\",\n    marginBottom: 10\n  },\n  centeredView: {\n    flex: 1,\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    marginTop: 22\n  },\n  buttonClose: {\n    backgroundColor: \"#2196F3\"\n  },\n  textStyle: {\n    color: \"white\",\n    fontWeight: \"bold\",\n    textAlign: \"center\"\n  },\n  modalText: {\n    marginBottom: 15,\n    textAlign: \"center\"\n  },\n  input: {\n    height: 30,\n    width: \"80%\",\n    padding: 10\n  },\n  title: {\n    backgroundColor: \"white\",\n    textAlign: \"center\",\n    fontSize: 15,\n    fontWeight: \"bold\",\n    padding: 5\n  }\n});","map":{"version":3,"sources":["/Users/mutabazi3/Projects/cis400/frontend/screens/LocationScreen.tsx"],"names":["React","useState","useEffect","useContext","Location","getNearbyFriends","sendMessage","setUserLocation","UserContext","FriendItemList","LocationScreen","navigation","handleLogoutCallback","authToken","location","setLocation","latitude","setLatitude","friends","setFriends","clickedFriend","setClickedFriend","clickedFriendId","setClickedFriendId","longitude","setLongitude","modalVisible","setModalVisible","errorMsg","setErrorMsg","isEnabled","setIsEnabled","message","setMessage","toggleSwitch","previousState","handleOpen","id","firstName","lastName","requestForegroundPermissionsAsync","status","console","log","then","resp","data","catch","error","getCurrentPositionAsync","coords","results","err","text","FlatListBasics","distance","item","handleSendingMessage","match","trimmedMessage","trim","response","navigate","friendId","split","styles","container","length","title","Alert","alert","centeredView","modalView","width","backgroundColor","marginBottom","position","right","imageModal","uri","fontSize","marginTop","flexDirection","button","alignItems","borderWidth","borderColor","borderRadius","paddingLeft","paddingRight","flex","input","e","StyleSheet","create","map","height","zIndex","margin","padding","shadowColor","shadowOffset","shadowOpacity","shadowRadius","elevation","justifyContent","buttonClose","textStyle","color","fontWeight","textAlign","modalText"],"mappings":";;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,EAAqCC,UAArC,QAAuD,OAAvD;;;;;;;;;;;AAgBA,OAAO,KAAKC,QAAZ,MAA0B,eAA1B;AACA,SAASC,gBAAT,EAA2BC,WAA3B,EAAwCC,eAAxC;AACA,SAASC,WAAT;AACA,SAASC,cAAT;;;AAEA,eAAe,SAASC,cAAT,OAA8D;AAAA,MAApCC,UAAoC,QAApCA,UAAoC;AAAA,MAAxBC,oBAAwB,QAAxBA,oBAAwB;AAC3E,MAAMC,SAAS,GAAGV,UAAU,CAACK,WAAD,CAA5B;;AACA,kBAAgCP,QAAQ,CAAC,IAAD,CAAxC;AAAA;AAAA,MAAOa,QAAP;AAAA,MAAiBC,WAAjB;;AACA,mBAAgCd,QAAQ,CAAC,MAAD,CAAxC;AAAA;AAAA,MAAOe,QAAP;AAAA,MAAiBC,WAAjB;;AACA,mBAA8BhB,QAAQ,CAAC,IAAD,CAAtC;AAAA;AAAA,MAAOiB,OAAP;AAAA,MAAgBC,UAAhB;;AACA,mBAA0ClB,QAAQ,CAAC,EAAD,CAAlD;AAAA;AAAA,MAAOmB,aAAP;AAAA,MAAsBC,gBAAtB;;AACA,mBAA8CpB,QAAQ,CAAC,EAAD,CAAtD;AAAA;AAAA,MAAOqB,eAAP;AAAA,MAAwBC,kBAAxB;;AACA,oBAAkCtB,QAAQ,CAAC,OAAD,CAA1C;AAAA;AAAA,MAAOuB,SAAP;AAAA,MAAkBC,YAAlB;;AACA,oBAAwCxB,QAAQ,CAAC,KAAD,CAAhD;AAAA;AAAA,MAAOyB,YAAP;AAAA,MAAqBC,eAArB;;AACA,oBAAgC1B,QAAQ,CAAC,IAAD,CAAxC;AAAA;AAAA,MAAO2B,QAAP;AAAA,MAAiBC,WAAjB;;AACA,oBAAkC5B,QAAQ,CAAC,KAAD,CAA1C;AAAA;AAAA,MAAO6B,SAAP;AAAA,MAAkBC,YAAlB;;AACA,oBAA8B9B,QAAQ,CAAC,EAAD,CAAtC;AAAA;AAAA,MAAO+B,OAAP;AAAA,MAAgBC,UAAhB;;AACA,MAAMC,YAAY,GAAG,SAAfA,YAAe;AAAA,WAAMH,YAAY,CAAC,UAACI,aAAD;AAAA,aAAmB,CAACA,aAApB;AAAA,KAAD,CAAlB;AAAA,GAArB;;AAGA,MAAMC,UAAU,GAAG,SAAbA,UAAa,CAACC,EAAD,EAAaC,SAAb,EAAgCC,QAAhC,EAAqD;AACtElB,IAAAA,gBAAgB,CAAIiB,SAAJ,SAAiBC,QAAjB,CAAhB;AACAhB,IAAAA,kBAAkB,CAACc,EAAD,CAAlB;AACAV,IAAAA,eAAe,CAAC,IAAD,CAAf;AACD,GAJD;;AAKAzB,EAAAA,SAAS,CAAC,YAAM;AACd,KAAC;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+CACwBE,QAAQ,CAACoC,iCAAT,EADxB;;AAAA;AAAA;AACOC,cAAAA,MADP,yBACOA,MADP;AAECC,cAAAA,OAAO,CAACC,GAAR,CAAY,OAAZ,EAAqBF,MAArB;;AAFD,oBAGKA,MAAM,KAAK,SAHhB;AAAA;AAAA;AAAA;;AAIGZ,cAAAA,WAAW,CAAC,0CAAD,CAAX;AAJH;;AAAA;AAQCxB,cAAAA,gBAAgB,CAACQ,SAAD,CAAhB,CACG+B,IADH,CACQ,UAACC,IAAD,EAAU;AACd1B,gBAAAA,UAAU,CAAC0B,IAAI,CAACC,IAAN,CAAV;AACAJ,gBAAAA,OAAO,CAACC,GAAR,CAAYE,IAAI,CAACC,IAAjB;AACD,eAJH,EAKGC,KALH,CAKS,UAACC,KAAD,EAAW;AAChBN,gBAAAA,OAAO,CAACC,GAAR,CAAY,oBAAZ,EAAkCK,KAAK,CAAChB,OAAxC;AACD,eAPH;AASA5B,cAAAA,QAAQ,CAAC6C,uBAAT,CAAiC,EAAjC,EAAqCL,IAArC,CAA0C,UAACC,IAAD,EAAU;AAClD,oBAAIK,MAAM,GAAGL,IAAI,CAAC,QAAD,CAAjB;AACA5B,gBAAAA,WAAW,CAACiC,MAAM,CAAC,UAAD,CAAP,CAAX;AACAzB,gBAAAA,YAAY,CAACyB,MAAM,CAAC,WAAD,CAAP,CAAZ;AAEA3C,gBAAAA,eAAe,CAACM,SAAD,EAAYqC,MAAM,CAAC,WAAD,CAAlB,EAAiCA,MAAM,CAAC,UAAD,CAAvC,CAAf,CACGN,IADH,CACQ,UAACO,OAAD,EAAa;AACjBT,kBAAAA,OAAO,CAACC,GAAR,CAAY,gBAAZ,EAA8BQ,OAAO,CAACV,MAAtC;AACD,iBAHH,EAIGM,KAJH,CAIS,UAACK,GAAD,EAAS;AACdV,kBAAAA,OAAO,CAACC,GAAR,CAAYS,GAAZ;AACD,iBANH;AAOD,eAZD;;AAjBD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAD;AA+BD,GAhCQ,EAgCN,EAhCM,CAAT;AAkCA,MAAIC,IAAI,GAAG,WAAX;;AACA,MAAIzB,QAAJ,EAAc;AACZyB,IAAAA,IAAI,GAAGzB,QAAP;AACD,GAFD,MAEO,IAAId,QAAJ,EAAc,CACpB;;AACD,MAAMwC,cAAc,GAAG,SAAjBA,cAAiB,CAACC,QAAD,EAAc;AACnC,WACE,KAAC,IAAD;AAAA,gBACE,KAAC,QAAD;AACE,QAAA,IAAI,EAAErC,OAAO,GAAGA,OAAO,MAAIqC,QAAJ,CAAV,GAA4B,EAD3C;AAEE,QAAA,UAAU,EAAE;AAAA,cAAGC,IAAH,SAAGA,IAAH;AAAA,iBACV,KAAC,cAAD;AAAgB,YAAA,IAAI,EAAEA,IAAtB;AAA4B,YAAA,UAAU,EAAEpB;AAAxC,YADU;AAAA;AAFd;AADF,MADF;AAUD,GAXD;;AAaA,MAAMqB,oBAAoB,GAAG,SAAvBA,oBAAuB,GAAM;AACjC,QAAIzB,OAAO,CAAC0B,KAAR,CAAc,cAAd,CAAJ,EAAmC;AACjC,UAAIC,cAAc,GAAG3B,OAAO,CAAC4B,IAAR,EAArB;AACAtD,MAAAA,WAAW,CAACO,SAAD,EAAYS,eAAZ,EAA6BqC,cAA7B,CAAX,CACGf,IADH,CACQ,UAACiB,QAAD,EAAc;AAClBnB,QAAAA,OAAO,CAACC,GAAR,CAAY,iBAAZ,EAA+BkB,QAA/B;AACD,OAHH,EAIGd,KAJH,CAIS,UAACK,GAAD,EAAS;AACdV,QAAAA,OAAO,CAACC,GAAR,CAAYS,GAAZ;AACD,OANH;AAOAzB,MAAAA,eAAe,CAAC,CAACD,YAAF,CAAf;AACAf,MAAAA,UAAU,CAACmD,QAAX,CAAoB,SAApB,EAA+B;AAC7BC,QAAAA,QAAQ,EAAEzC,eADmB;AAE7BgB,QAAAA,SAAS,EAAElB,aAAa,CAAC4C,KAAd,CAAoB,GAApB,EAAyB,CAAzB,CAFkB;AAG7BzB,QAAAA,QAAQ,EAAEnB,aAAa,CAAC4C,KAAd,CAAoB,GAApB,EAAyB,CAAzB;AAHmB,OAA/B;AAKD;AACF,GAjBD;;AAkBA,SACE,MAAC,IAAD;AAAM,IAAA,KAAK,EAAEC,MAAM,CAACC,SAApB;AAAA,eAeGhD,OAAO,IAAIA,OAAO,CAAC,GAAD,CAAP,CAAaiD,MAAb,GAAsB,CAAjC,GACC,MAAC,IAAD;AAAA,iBACE,KAAC,IAAD;AAAM,QAAA,KAAK,EAAEF,MAAM,CAACG,KAApB;AAAA;AAAA,QADF,EAEGd,cAAc,CAAC,CAAD,CAFjB;AAAA,MADD,GAMC,KAAC,IAAD,KArBJ,EAuBGpC,OAAO,IAAIA,OAAO,CAAC,GAAD,CAAP,CAAaiD,MAAb,GAAsB,CAAjC,GACC,MAAC,IAAD;AAAA,iBACE,KAAC,IAAD;AAAM,QAAA,KAAK,EAAEF,MAAM,CAACG,KAApB;AAAA;AAAA,QADF,EAEGd,cAAc,CAAC,CAAD,CAFjB;AAAA,MADD,GAMC,KAAC,IAAD,KA7BJ,EA+BGpC,OAAO,IAAIA,OAAO,CAAC,GAAD,CAAP,CAAaiD,MAAb,GAAsB,CAAjC,GACC,MAAC,IAAD;AAAA,iBACE,KAAC,IAAD;AAAM,QAAA,KAAK,EAAEF,MAAM,CAACG,KAApB;AAAA;AAAA,QADF,EAEGd,cAAc,CAAC,CAAD,CAFjB;AAAA,MADD,GAMC,KAAC,IAAD,KArCJ,EAwCE,KAAC,KAAD;AACE,MAAA,aAAa,EAAC,MADhB;AAEE,MAAA,WAAW,EAAE,IAFf;AAGE,MAAA,OAAO,EAAE5B,YAHX;AAIE,MAAA,cAAc,EAAE,0BAAM;AACpB2C,QAAAA,KAAK,CAACC,KAAN,CAAY,wBAAZ;AACA3C,QAAAA,eAAe,CAAC,CAACD,YAAF,CAAf;AACD,OAPH;AAAA,gBASE,KAAC,IAAD;AAAM,QAAA,KAAK,EAAEuC,MAAM,CAACM,YAApB;AAAA,kBACE,MAAC,IAAD;AAAM,UAAA,KAAK,EAAEN,MAAM,CAACO,SAApB;AAAA,qBACE,KAAC,IAAD;AACE,YAAA,KAAK,EAAE;AACLC,cAAAA,KAAK,EAAE,MADF;AAELC,cAAAA,eAAe,EAAE,MAFZ;AAGLC,cAAAA,YAAY,EAAE;AAHT,aADT;AAAA,sBAOE,KAAC,IAAD;AACE,cAAA,KAAK,EAAE;AACLC,gBAAAA,QAAQ,EAAE,UADL;AAELC,gBAAAA,KAAK,EAAE;AAFF,eADT;AAAA,wBAME,KAAC,MAAD;AACE,gBAAA,KAAK,EAAC,OADR;AAEE,gBAAA,OAAO,EAAE,mBAAM;AAEb5C,kBAAAA,UAAU,CAAC,EAAD,CAAV;AACAN,kBAAAA,eAAe,CAAC,CAACD,YAAF,CAAf;AACD;AANH;AANF;AAPF,YADF,EAyBE,KAAC,KAAD;AACE,YAAA,KAAK,EAAEuC,MAAM,CAACa,UADhB;AAEE,YAAA,MAAM,EAAE;AACNC,cAAAA,GAAG,EAAE;AADC;AAFV,YAzBF,EA+BE,KAAC,IAAD;AAAM,YAAA,KAAK,EAAE;AAAEC,cAAAA,QAAQ,EAAE;AAAZ,aAAb;AAAA,sBAAgC5D;AAAhC,YA/BF,EAgCE,KAAC,IAAD;AAAA;AAAA,YAhCF,EAiCE,MAAC,IAAD;AAAM,YAAA,KAAK,EAAE;AAAEqD,cAAAA,KAAK,EAAE,KAAT;AAAgBQ,cAAAA,SAAS,EAAE;AAA3B,aAAb;AAAA,uBACE,KAAC,gBAAD;AACE,cAAA,KAAK,EAAE;AAAEC,gBAAAA,aAAa,EAAE;AAAjB,eADT;AAEE,cAAA,OAAO,EAAE,mBAAM;AACbjD,gBAAAA,UAAU,CAAC,uBAAD,CAAV;AACD,eAJH;AAAA,wBAME,KAAC,IAAD;AAAM,gBAAA,KAAK,EAAEgC,MAAM,CAACkB,MAApB;AAAA,0BACE,KAAC,IAAD;AAAA;AAAA;AADF;AANF,cADF,EAWE,KAAC,gBAAD;AACE,cAAA,OAAO,EAAE,mBAAM;AACblD,gBAAAA,UAAU,CAAC,qBAAD,CAAV;AACD,eAHH;AAAA,wBAKE,KAAC,IAAD;AAAM,gBAAA,KAAK,EAAEgC,MAAM,CAACkB,MAApB;AAAA,0BACE,KAAC,IAAD;AAAA;AAAA;AADF;AALF,cAXF,EAoBE,KAAC,gBAAD;AACE,cAAA,OAAO,EAAE,mBAAM;AACblD,gBAAAA,UAAU,CAAC,qBAAD,CAAV;AACD,eAHH;AAAA,wBAKE,KAAC,IAAD;AAAM,gBAAA,KAAK,EAAEgC,MAAM,CAACkB,MAApB;AAAA,0BACE,KAAC,IAAD;AAAA;AAAA;AADF;AALF,cApBF;AAAA,YAjCF,EAgEE,MAAC,IAAD;AACE,YAAA,KAAK,EAAE;AACLD,cAAAA,aAAa,EAAE,KADV;AAELE,cAAAA,UAAU,EAAE,QAFP;AAGLC,cAAAA,WAAW,EAAE,CAHR;AAILC,cAAAA,WAAW,EAAE,SAJR;AAKLC,cAAAA,YAAY,EAAE,EALT;AAMLC,cAAAA,WAAW,EAAE,EANR;AAOLC,cAAAA,YAAY,EAAE,EAPT;AAQLhB,cAAAA,KAAK,EAAE;AARF,aADT;AAAA,uBAYE,KAAC,IAAD;AAAM,cAAA,KAAK,EAAE;AAAEiB,gBAAAA,IAAI,EAAE;AAAR,eAAb;AAAA,wBACE,KAAC,SAAD;AACE,gBAAA,KAAK,EAAE1D,OADT;AAEE,gBAAA,KAAK,EAAEiC,MAAM,CAAC0B,KAFhB;AAGE,gBAAA,WAAW,EAAC,qBAHd;AAIE,gBAAA,YAAY,EAAE,sBAACC,CAAD,EAAO;AACnB3D,kBAAAA,UAAU,CAAC2D,CAAD,CAAV;AACD;AANH;AADF,cAZF,EAuBE,KAAC,IAAD;AAAM,cAAA,KAAK,EAAE;AAAEF,gBAAAA,IAAI,EAAE;AAAR,eAAb;AAAA,wBACE,KAAC,MAAD;AAAQ,gBAAA,KAAK,EAAC,MAAd;AAAqB,gBAAA,OAAO,EAAEjC;AAA9B;AADF,cAvBF;AAAA,YAhEF;AAAA;AADF;AATF,MAxCF;AAAA,IADF;AAmJD;AAED,IAAMQ,MAAM,GAAG4B,UAAU,CAACC,MAAX,CAAkB;AAC/B5B,EAAAA,SAAS,EAAE;AACTwB,IAAAA,IAAI,EAAE;AADG,GADoB;AAI/BK,EAAAA,GAAG,EAAE;AACHtB,IAAAA,KAAK,EAAE,MADJ;AAEHuB,IAAAA,MAAM,EAAE,MAFL;AAGHC,IAAAA,MAAM,EAAE;AAHL,GAJ0B;AAS/BnB,EAAAA,UAAU,EAAE;AACVL,IAAAA,KAAK,EAAE,GADG;AAEVuB,IAAAA,MAAM,EAAE,GAFE;AAGVT,IAAAA,YAAY,EAAE,EAHJ;AAIVZ,IAAAA,YAAY,EAAE;AAJJ,GATmB;AAe/BH,EAAAA,SAAS,EAAE;AACT0B,IAAAA,MAAM,EAAE,EADC;AAETxB,IAAAA,eAAe,EAAE,OAFR;AAGTa,IAAAA,YAAY,EAAE,EAHL;AAITY,IAAAA,OAAO,EAAE,CAJA;AAKTf,IAAAA,UAAU,EAAE,QALH;AAMTgB,IAAAA,WAAW,EAAE,MANJ;AAOTC,IAAAA,YAAY,EAAE;AACZ5B,MAAAA,KAAK,EAAE,CADK;AAEZuB,MAAAA,MAAM,EAAE;AAFI,KAPL;AAWTM,IAAAA,aAAa,EAAE,IAXN;AAYTC,IAAAA,YAAY,EAAE,CAZL;AAaTC,IAAAA,SAAS,EAAE,CAbF;AAcTR,IAAAA,MAAM,EAAE,KAdC;AAeTvB,IAAAA,KAAK,EAAE;AAfE,GAfoB;AAgC/BU,EAAAA,MAAM,EAAE;AACNI,IAAAA,YAAY,EAAE,EADR;AAENY,IAAAA,OAAO,EAAE,EAFH;AAGNK,IAAAA,SAAS,EAAE,CAHL;AAIN9B,IAAAA,eAAe,EAAE,SAJX;AAKNC,IAAAA,YAAY,EAAE;AALR,GAhCuB;AAuC/BJ,EAAAA,YAAY,EAAE;AACZmB,IAAAA,IAAI,EAAE,CADM;AAEZe,IAAAA,cAAc,EAAE,QAFJ;AAGZrB,IAAAA,UAAU,EAAE,QAHA;AAIZH,IAAAA,SAAS,EAAE;AAJC,GAvCiB;AA6C/ByB,EAAAA,WAAW,EAAE;AACXhC,IAAAA,eAAe,EAAE;AADN,GA7CkB;AAgD/BiC,EAAAA,SAAS,EAAE;AACTC,IAAAA,KAAK,EAAE,OADE;AAETC,IAAAA,UAAU,EAAE,MAFH;AAGTC,IAAAA,SAAS,EAAE;AAHF,GAhDoB;AAqD/BC,EAAAA,SAAS,EAAE;AACTpC,IAAAA,YAAY,EAAE,EADL;AAETmC,IAAAA,SAAS,EAAE;AAFF,GArDoB;AAyD/BnB,EAAAA,KAAK,EAAE;AACLK,IAAAA,MAAM,EAAE,EADH;AAELvB,IAAAA,KAAK,EAAE,KAFF;AAGL0B,IAAAA,OAAO,EAAE;AAHJ,GAzDwB;AA8D/B/B,EAAAA,KAAK,EAAE;AACLM,IAAAA,eAAe,EAAE,OADZ;AAELoC,IAAAA,SAAS,EAAE,QAFN;AAGL9B,IAAAA,QAAQ,EAAE,EAHL;AAIL6B,IAAAA,UAAU,EAAE,MAJP;AAKLV,IAAAA,OAAO,EAAE;AALJ;AA9DwB,CAAlB,CAAf","sourcesContent":["import React, { useState, useEffect, useContext } from \"react\";\nimport {\n  Text,\n  View,\n  StyleSheet,\n  Switch,\n  Alert,\n  Modal,\n  TouchableOpacity,\n  Image,\n  Button,\n  TextInput,\n  Pressable,\n  FlatList,\n  SectionList,\n} from \"react-native\";\nimport * as Location from \"expo-location\";\nimport { getNearbyFriends, sendMessage, setUserLocation } from \"../api\";\nimport { UserContext } from \"../Context\";\nimport { FriendItemList } from \"../components/FriendItemList\";\n\nexport default function LocationScreen({ navigation, handleLogoutCallback }) {\n  const authToken = useContext(UserContext);\n  const [location, setLocation] = useState(null);\n  const [latitude, setLatitude] = useState(1.9441);\n  const [friends, setFriends] = useState(null);\n  const [clickedFriend, setClickedFriend] = useState(\"\");\n  const [clickedFriendId, setClickedFriendId] = useState(\"\");\n  const [longitude, setLongitude] = useState(30.0619);\n  const [modalVisible, setModalVisible] = useState(false);\n  const [errorMsg, setErrorMsg] = useState(null);\n  const [isEnabled, setIsEnabled] = useState(false);\n  const [message, setMessage] = useState(\"\");\n  const toggleSwitch = () => setIsEnabled((previousState) => !previousState);\n  //retrieves the users location\n\n  const handleOpen = (id: string, firstName: string, lastName: string) => {\n    setClickedFriend(`${firstName} ${lastName}`);\n    setClickedFriendId(id);\n    setModalVisible(true);\n  };\n  useEffect(() => {\n    (async () => {\n      let { status } = await Location.requestForegroundPermissionsAsync();\n      console.log(\"hahah\", status);\n      if (status !== \"granted\") {\n        setErrorMsg(\"Permission to access location was denied\");\n        return;\n      }\n      //retrieving the user token\n      getNearbyFriends(authToken)\n        .then((resp) => {\n          setFriends(resp.data);\n          console.log(resp.data);\n        })\n        .catch((error) => {\n          console.log(\"error near friends\", error.message);\n        });\n      //Getting the user location\n      Location.getCurrentPositionAsync({}).then((resp) => {\n        var coords = resp[\"coords\"];\n        setLatitude(coords[\"latitude\"]);\n        setLongitude(coords[\"longitude\"]);\n        //setting the user location in the backend\n        setUserLocation(authToken, coords[\"longitude\"], coords[\"latitude\"])\n          .then((results) => {\n            console.log(\"location saved\", results.status);\n          })\n          .catch((err) => {\n            console.log(err);\n          });\n      });\n    })();\n  }, []);\n\n  let text = \"Waiting..\";\n  if (errorMsg) {\n    text = errorMsg;\n  } else if (location) {\n  }\n  const FlatListBasics = (distance) => {\n    return (\n      <View>\n        <FlatList\n          data={friends ? friends[`${distance}`] : []}\n          renderItem={({ item }) => (\n            <FriendItemList data={item} handleOpen={handleOpen} />\n          )}\n        />\n      </View>\n    );\n  };\n\n  const handleSendingMessage = () => {\n    if (message.match(/(?!^ +$)^.+$/)) {\n      let trimmedMessage = message.trim();\n      sendMessage(authToken, clickedFriendId, trimmedMessage)\n        .then((response) => {\n          console.log(\"testing chating\", response);\n        })\n        .catch((err) => {\n          console.log(err);\n        });\n      setModalVisible(!modalVisible);\n      navigation.navigate(\"message\", {\n        friendId: clickedFriendId,\n        firstName: clickedFriend.split(\" \")[0],\n        lastName: clickedFriend.split(\" \")[1],\n      });\n    }\n  };\n  return (\n    <View style={styles.container}>\n      {/* <View\n        style={{ backgroundColor: \"white\", height: 40, flexDirection: \"row\" }}\n      >\n        <Button title=\"Logout\" onPress={() => handleLogoutCallback()} />\n        <Switch\n          style={{ position: \"absolute\", top: 0, right: 0, margin: 5 }}\n          trackColor={{ false: \"#ffffff\", true: \"#ffffff\" }}\n          thumbColor={isEnabled ? \"#157106\" : \"#FF0000\"}\n          ios_backgroundColor=\"#fffff\"\n          onValueChange={toggleSwitch}\n          value={isEnabled}\n        />\n      </View> */}\n\n      {friends && friends[\"1\"].length > 0 ? (\n        <View>\n          <Text style={styles.title}>1 mile away</Text>\n          {FlatListBasics(1)}\n        </View>\n      ) : (\n        <View />\n      )}\n      {friends && friends[\"2\"].length > 0 ? (\n        <View>\n          <Text style={styles.title}>2 mile away</Text>\n          {FlatListBasics(2)}\n        </View>\n      ) : (\n        <View />\n      )}\n      {friends && friends[\"3\"].length > 0 ? (\n        <View>\n          <Text style={styles.title}>3 mile away</Text>\n          {FlatListBasics(3)}\n        </View>\n      ) : (\n        <View />\n      )}\n\n      <Modal\n        animationType=\"fade\"\n        transparent={true}\n        visible={modalVisible}\n        onRequestClose={() => {\n          Alert.alert(\"Modal has been closed.\");\n          setModalVisible(!modalVisible);\n        }}\n      >\n        <View style={styles.centeredView}>\n          <View style={styles.modalView}>\n            <View\n              style={{\n                width: \"100%\",\n                backgroundColor: \"blue\",\n                marginBottom: 30,\n              }}\n            >\n              <View\n                style={{\n                  position: \"absolute\",\n                  right: 0,\n                }}\n              >\n                <Button\n                  title=\"Close\"\n                  onPress={() => {\n                    //clear the message in the modal\n                    setMessage(\"\");\n                    setModalVisible(!modalVisible);\n                  }}\n                ></Button>\n              </View>\n            </View>\n\n            <Image\n              style={styles.imageModal}\n              source={{\n                uri: \"https://images-na.ssl-images-amazon.com/images/I/81nKBuQzyjL.jpg\",\n              }}\n            />\n            <Text style={{ fontSize: 28 }}>{clickedFriend}</Text>\n            <Text>Quick Texts</Text>\n            <View style={{ width: \"80%\", marginTop: 10 }}>\n              <TouchableOpacity\n                style={{ flexDirection: \"column\" }}\n                onPress={() => {\n                  setMessage(\"Wanna get some lunch?\");\n                }}\n              >\n                <View style={styles.button}>\n                  <Text>Wanna get some lunch?</Text>\n                </View>\n              </TouchableOpacity>\n              <TouchableOpacity\n                onPress={() => {\n                  setMessage(\"What are you up to?\");\n                }}\n              >\n                <View style={styles.button}>\n                  <Text>What are you up to?</Text>\n                </View>\n              </TouchableOpacity>\n              <TouchableOpacity\n                onPress={() => {\n                  setMessage(\"Wanna grab a drink?\");\n                }}\n              >\n                <View style={styles.button}>\n                  <Text>Wanna grab a drink?</Text>\n                </View>\n              </TouchableOpacity>\n            </View>\n\n            <View\n              style={{\n                flexDirection: \"row\",\n                alignItems: \"center\",\n                borderWidth: 1,\n                borderColor: \"#DDDDDD\",\n                borderRadius: 40,\n                paddingLeft: 15,\n                paddingRight: 15,\n                width: \"80%\",\n              }}\n            >\n              <View style={{ flex: 2.25 }}>\n                <TextInput\n                  value={message}\n                  style={styles.input}\n                  placeholder=\"useless placeholder\"\n                  onChangeText={(e) => {\n                    setMessage(e);\n                  }}\n                />\n              </View>\n\n              <View style={{ flex: 0.75 }}>\n                <Button title=\"send\" onPress={handleSendingMessage} />\n              </View>\n            </View>\n          </View>\n        </View>\n      </Modal>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  map: {\n    width: \"100%\",\n    height: \"100%\",\n    zIndex: 1,\n  },\n  imageModal: {\n    width: 100,\n    height: 100,\n    borderRadius: 50,\n    marginBottom: 5,\n  },\n  modalView: {\n    margin: 20,\n    backgroundColor: \"white\",\n    borderRadius: 10,\n    padding: 5,\n    alignItems: \"center\",\n    shadowColor: \"#000\",\n    shadowOffset: {\n      width: 0,\n      height: 2,\n    },\n    shadowOpacity: 0.25,\n    shadowRadius: 4,\n    elevation: 5,\n    height: \"60%\",\n    width: \"80%\",\n  },\n  button: {\n    borderRadius: 20,\n    padding: 10,\n    elevation: 2,\n    backgroundColor: \"#DDDDDD\",\n    marginBottom: 10,\n  },\n  centeredView: {\n    flex: 1,\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    marginTop: 22,\n  },\n  buttonClose: {\n    backgroundColor: \"#2196F3\",\n  },\n  textStyle: {\n    color: \"white\",\n    fontWeight: \"bold\",\n    textAlign: \"center\",\n  },\n  modalText: {\n    marginBottom: 15,\n    textAlign: \"center\",\n  },\n  input: {\n    height: 30,\n    width: \"80%\",\n    padding: 10,\n  },\n  title: {\n    backgroundColor: \"white\",\n    textAlign: \"center\",\n    fontSize: 15,\n    fontWeight: \"bold\",\n    padding: 5,\n  },\n});\n"]},"metadata":{},"sourceType":"module"}